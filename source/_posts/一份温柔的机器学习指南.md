---
title: 一份温柔的机器学习指南
tags: 软件工程师的机器学习
date: 2017-12-06 08:49:30
---

>文章来自[Raúl Garreta](https://monkeylearn.com/blog/author/raul/)的《[A Gentle Guide to Machine Learning](https://monkeylearn.com/blog/gentle-guide-to-machine-learning/)》

# 一份温柔的机器学习指南
机器学习是人工智能中的一个子领域，它构建了一些算法，使计算机能够从数据中学习执行任务，而不是被明确编程。

理解它了？我们可以让机器学会做事！我第一次听到这个消息，这让我大跌眼镜。这意味着我们可以让计算机自己学习东西！

学习的能力是智能最重要的方面之一。把这种力量转化为机器的能力，听起来就是使机器变得更加智能的一大步。而实际上，机器学习是当今人工智能进步最大的领域；机器学习现在正在成为一个流行的话题，并推动了产生更高智能机器的可能性。

本文将尝试给新手读者简要介绍机器学习。我将概述使用机器学习时的重要的概念，应用和挑战。这个帖子的目标不是对这个话题进行正式的或者详尽的描述，而是给出一些最初的概念来请读者继续深入。

## 机器学习的真实情况
好吧，不是所有的都像它听起来一样美丽，机器学习有其局限性。至今，我们仍然无法构如“<i>星际迷航</i>”中的“<i>Data</i>”或“<i>2001太空漫遊</i>”中的“<i>哈尔9000</i>”。然而，我们有很多机器学习优雅的工作的<strong>实际应用</strong>的例子。以下是一些最常见的实用机器学习应用程序类别：
### 图像处理（Image Processing）
图像处理问题基本上要分析图像来获取数据或做一些转换。一些例子是：
* <strong>图像标记（Image tagging）</strong>，就像在Facebook中一样，算法会自动检测到您的脸部或朋友的脸部出现在照片中。基本上，机器学习算法从您手动标记的照片中学习到这些知识。
* <strong>光学字符识别（Optical Character Recognition (OCR)）</strong>，当算法学习将手稿或扫描文本文档转换为数字版本时。该算法必须学习将书面字符的图像转换成相应的数字字母。
* <strong>自动汽车（Self-driving cars）</strong>，允许汽车自行驾驶的部分机制使用图像处理。机器学习算法通过查看摄像机所拍摄的每一帧来了解哪里是道路的边缘，是否有停车标志或汽车正在接近。

### 文本分析（Text Analysis）
文本分析是我们从文本中提取或分类信息的过程，如推文，电子邮件，聊天，文档等。一些流行的示例是：
* <strong>垃圾邮件过滤（Spam filtering）</strong>，文本分类最知名的应用之一（将一个类别分配给一个文本）。垃圾邮件过滤器学习根据内容和主题将电子邮件分类为垃圾邮件或正常邮件。
* <strong>情感分析（Sentiment Analysis）</strong>，文本分类的另一个应用，其中算法必须学习根据作者所表达的情绪将分类为正面，中性或负面。
* <strong>信息提取（Information Extraction）</strong>，从文本中学习提取特定的信息或数据，例如提取地址，实体，关键字等。

### 数据挖掘（Data Mining）
数据挖掘是发现模式或根据数据进行预测的过程。这个定义有点通用，但是可以把它看作是从数据库的一个巨大的表中挖掘有用的信息。每一行都是我们的训练实例，每一列都是一个特征。我们可能对根据其余的列预测该表中的新列感兴趣，或者发现模式来对行进行分组。例如：
* <strong>异常检测（Anomaly detection）</strong>：检测异常值，例如信用卡欺诈检测，您可以检测哪些交易是来自用户通常采购模式的异常值。
* <strong>关联规则（Association rules）</strong>：例如，在超市或电子商务网站，您可以通过查看哪些产品一起购买来发现客户的购买习惯。这些信息可以用于营销目的。
* <strong>分组（Grouping）</strong>：例如，在SaaS平台中，按照用户的行为或其个人资料对用户进行分组。
* <strong>预测（Predictions）</strong>：从其余的变量中预测变量（数据库中的列）。例如，通过学习当前客户的概况和信用评分，您可以预测银行新客户的信用评分。

### 视频游戏和机器人（Video Games & Robotics）
视频游戏和机器人技术一直是机器学习应用的一个巨大领域。一般来说，我们有一个代理角色（游戏角色或机器人）必须在环境中移动（在电子游戏中的虚拟环境或机器人的物理环境）。机器学习可以用来让代理人执行任务，例如在避开障碍物或敌人的情况下在环境中移动。在这些情况下使用的非常流行的机器学习技术是[强化学习](https://zh.wikipedia.org/wiki/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0)，代理人通过从强化的环境中来学习执行任务（如果碰到障碍物，强化是负，如果达到目标则强化为正）

## 好吧，我知道了机器学习的价值，但它是如何工作的？
我在十年前读到的关于机器学习的第一本书是Tom Mitchell的[Machine Learning](https://www.amazon.com/Machine-Learning-Tom-M-Mitchell/dp/0070428077/ref=sr_1_10?ie=UTF8&qid=1440450490&sr=8-10&keywords=machine+learning)。这本书是1997年写的，但是一些概念今天仍然有效。

从这本书中，我喜欢关于机器学习的以下正式定义：
> 计算机程序从<strong>经验E</strong>学习执行任务T，而其执行<strong>任务T</strong>的性能（由<strong>性能度量P</strong>测量）随着经验E读时间而改善。（A computer program is said to learn to perform a <strong>task T</strong> from <strong>experience E</strong>, if its performance at task T, as measured by a <strong>performance metric P</strong>, improves with experience E over time.）

例如，一个人工的游戏玩家需要下棋（任务T），可以通过查看以前的国际象棋比赛或者与对手（经验E）对抗来学习。它的性能度量P可以通过计算对人类的比赛的胜率来衡量。

让我们来通过更多的例子来更形象的描述：
* <strong>示例1</strong>：给系统一个图像，它得输出奥巴马（Barack Obama）脸是否出现在图片上（泛化就像Facebook的自动标记）。
* <strong>示例2</strong>：给系统一条微博，它得输出微博内容的情绪是属于积极的还是消极的。
* <strong>示例3</strong>：给系统一个人的档案，它得输出代表那个人会换信用卡欠款的可能性的分数。

在示例1中，任务是检测奥巴马（Barack Obama）的脸是否出现在图像中。经验就是一堆存在奥巴马的照片和一堆不存在奥巴马的照片。它的表现可以通过系统正确识别新照片的比率来衡量。

在示例2中，任务是分类推特的情绪。经验可能是一组推文和相应的情绪。它的表现可以通过系统正确新推文的情绪的百分比来衡量。

在示例3中，任务是分配一个信用评分。经验可以是一组用户档案及其相应的信用评分。它的表现可以通过信用分平方差来衡量（预测分数和预期分数之间的差异）。

为了让算法学习将输入转化为期望的输出，必须提供所谓的训练实例或<strong>训练示例（training examples）</strong>，这在Mitchell的定义中定义为经验E。训练集是一组实例，将作为机器学习算法学习执行所需任务的示例。很直观，不是吗？就像当你给一个小孩展示怎么扔球时，你把球扔很多次，告诉他怎么扔，通过看这些例子，他开始自己学习如何去扔。

每个训练实例通常被表示为一组固定的属性或<strong>特征（features）</strong>。这些特征是表征每个实例的方式。例如，在示例1中，图像可以由其每个像素的灰度级来表征。在示例2中，推文可以由在推文中出现的单词来表征。在示例3中，信用分可以用人的年龄，工资，职业等来表示。

计算和选择适当的特征来表示一个实例是使用机器学习最重要的任务之一，我们将在本文稍后介绍这一点。

## 机器学习算法的类别
在这一点上，我们不得不谈论两大类的机器学习算法：<strong>监督学习（Supervised Learning）</strong>或<strong>无监督学习（Unsupervised Learning）</strong>算法。这两种方法的主要区别在于，我们提供给算法的训练样例的 方式，算法如何使用它们以及解决问题的类型。

### 监督学习（Supervised Learning）
在[监督学习](https://zh.wikipedia.org/wiki/%E7%9B%A3%E7%9D%A3%E5%BC%8F%E5%AD%B8%E7%BF%92)的情况下，机器学习算法可以被看作是必须将特定输入转换为期望的输出的处理。

机器学习必须学习如何将每个可能的输入转换成正确的/期望的输出，因此每个训练示例具有特定的输入和期望的输出。

在关于人造棋手的例子中，我们的输入是一个特定的棋盘状态，输出将是这种情况下最好的移动方式。

根据输出的类型，我们有两个监督学习的子类：
#### 分类（Classification）
当输出值属于离散且有限集合时，我们谈论的是一个[分类问题](https://zh.wikipedia.org/wiki/%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98)。示例2可以解决为一个分类问题，输出是一个有限的选项集：正面，负面或中性。在这种情况下，我们的训练示例将如下所示：
![](table1.png)

#### 回归（Regression）
当输出值是一个连续数，例如一个概率，那么我们正在谈论的示一个[回归问题](https://zh.wikipedia.org/wiki/%E8%BF%B4%E6%AD%B8%E5%88%86%E6%9E%90)。示例3是一个回归问题，因为结果是0和1之间的数字，表示一个人将偿还债务的可能性。在这种情况下，我们的训练示例将如下所示：
![](table1.png)

监督学习是机器学习算法中最受欢迎的一类。使用这种方法的缺点是，对于每一个训练的例子，我们必须提供正确的输出，在很多情况下，这是非常昂贵的。例如，在情感分析的情况下，如果我们需要10,000个训练示例（微博），我们将不得不给每个微博标记正确的情绪（正面，负面或中性）。这将需要一群人阅读和标记每个推文（相当费时和无聊的任务）。这是机器学习算法一个<strong>通常的瓶颈（common bottleneck for Machine Learning）</strong>：收集高质量标记的训练数据。

### 无监督学习（Unsupervised Learning）
还有第二类机器学习算法，称为[无监督学习](https://zh.wikipedia.org/wiki/%E9%9D%9E%E7%9B%A3%E7%9D%A3%E5%BC%8F%E5%AD%B8%E7%BF%92)。在这种情况下，训练示例只需要算法的输入，而不需要期望的输出。典型的用例是发现训练样例之间的隐藏结构和关系。一个典型的例子是[聚类算法](https://zh.wikipedia.org/wiki/%E8%81%9A%E7%B1%BB%E5%88%86%E6%9E%90)，我们学习找到类似的实例或实例组（集群）。例如：我们有一篇新闻文章，我们希望得到类似的推荐。像[K-means](https://zh.wikipedia.org/wiki/K-%E5%B9%B3%E5%9D%87%E7%AE%97%E6%B3%95)这样的聚类算法只需要通过输入来“学习”。

## 机器学习算法（Machine Learning algorithms）
好吧，这是数学和逻辑起作用的时候了。为了将输入转换为所需的输出，我们可以使用不同的模型。机器学习不是一种独特的算法类型，也许你听说过支持向量机，朴素贝叶斯，决策树或深度学习。这些都是不同的机器学习算法，试图解决相同的问题：学习将每个输入转换为正确的输出。

这些不同的机器学习算法使用不同的范例或技术来完成学习过程，并代表他们所学知识。

但是在我们继续讨论每个算法之前，一个共同的原则是，机器学习算法试图<strong>进行概括</strong>。也就是说，他们试图用最简单的理论来解释一些东西，这个原理就是所谓的[奥卡姆剃刀(Occam’s razor)](https://zh.wikipedia.org/wiki/%E5%A5%A5%E5%8D%A1%E5%A7%86%E5%89%83%E5%88%80)。无论使用何种范例，每一个机器学习算法都会尝试创建解释大部分训练实例的最简单的假设（最少假设的假设）。

有很多机器学习算法，但是让我们简单地提一下最流行的三个算法：
* <strong>支持向量机（Support Vector Machines）</strong>：该模型试图在高维空间中建立一组超平面，试图通过获得不同类别的最近实例之间的最大分离来区分不同类别的实例。这个概念直观简单，但是模型可以非常复杂和强大。事实上，对于某些领域来说，它是当今最好的机器学习算法之一。
* <strong>概率模型（Probabilistic Models）</strong>：这些模型通常试图通过用概率分布建模问题来预测正确的输出。也许在这个类别中最流行的算法是[朴素贝叶斯分类器](https://zh.wikipedia.org/wiki/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%88%86%E7%B1%BB%E5%99%A8)，它使用贝叶斯定理和特征之间的强独立性假设。除了一个简单而强大的模型之外，他们的优点之一就是他们不仅返回了预测，还返回了确定的程度，这可是非常有用的。
* <strong>深度学习（Deep Learning）</strong>：是基于[人工神经网络](https://zh.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C)模型的机器学习新趋势。神经网络有一个相互连接的方法，他们试图模仿（以非常简单的方式）大脑的工作方式。基本上它们是由组织在各个层次上的一系列相互关联的神经元（处理的基本单元）组成的。深度学习用一些话来说就是开发了更深层次的新的结构，并且改进了学习算法使其不仅能学习，还能自动以更高层次的抽象来建立结构用来表示最重要的特征。

## 处理机器学习的重要方面
同样，机器学习听起来像一个美丽的概念，并且它就是，但有机器学习的一些涉及过程不是那么自动的。实际上，设计解决方案时需要多步手动步骤。尽管如此，为了取得不错的结果，这些方面也是<strong>非常重要</strong>的。其中一些方面是：

### 我应该使用哪种类型的机器学习算法？
#### 有监督或无监督？
你有标记好的数据吗？也就是说，输入拥有其相应的输出？在这种情况下，你可以应用监督学习算法。如果不是，也许无监督算法可以解决这个问题。

#### 分类，回归或聚类？
这主要取决于你想要解决的问题。如果要标记数据（在一组离散选项中分配标签），分类可能是正确的选择。另一方面，如果您需要分配一个数字，例如分数，回归可能是您的最佳选择。也许你需要的是根据用户目前在电子商务网站上看到的内容向用户推荐类似的产品，在这种情况下，聚类可能是最好的选择。

#### 深度学习，支持向量机，朴素贝叶斯，决策树...哪一个是最好的？
我的答案是：没有一个。显然，深度学习和支持向量机已经证明了它们在不同的应用中的强大和多面。但要考虑到，根据具体的应用，一些机器学习算法可能是一个比其他更好的选择。这要取决他们各自的优势，然后试试看！

### 特征工程
特征工程是我们提取和选择最重要的特征的过程，用来表示我们的机器学习算法要处理的训练样例和实例。这个过程是机器学习最重要的方面之一（但是有时没有给予足够的重视）。

请注意：如果您不提供优质的特征给您的算法，结果将是不好的，无论您是否使用最好的机器学习算法。这就像在黑暗中学着用眼睛去阅读，不管你有多聪明，你都无法做到这一点。

#### 特征提取
为了给机器学习算法提供数据，通常必须将原始数据转换成算法可以“理解”的东西。该过程被称为<strong>特征提取</strong>。通常我们说的是将原始数据转换为特征向量。

在示例1中，我们如何为机器学习算法提供图像？

那么，一个简单的方法就是将图像转换成一个向量，其中每个分量都是图像中每个像素的灰度值。 因此，每个组件或特征将是介于0到255之间的数字，0是黑色，255是白色，以及1到254之间的范围是可能的灰色色调。

这种方法可能有效，但是如果我们提供更高层次的特征，可能会更好：
* 图像是否包含一个人的脸？
* 肤色是什么？
* 眼睛的颜色是什么？
* 脸上有头发吗？
* ...

这些是更高层次的特征，给算法提供更多的知识，而不仅仅是每个像素的灰度级（并且其计算可以通过其他机器学习算法来完成！）。通过提供更高层次的特征，我们可以“帮助”机器学习算法获得更好的信息，从而确定我或他人的脸部是否出现在图像中。

如果我们提供更好的特征提取：
* 我们将有更多的几率让我们的算法将学习到如何执行所期望的任务。
* 我们可能需要更少的训练数据来学习。
* 因此，我们可能大大减少训练模型所需的时间。

#### 特征选择
有时（不是说多数情况下），我们选择给我们的算法提供的特征可能是没用的。例如，当试图标记推特的情绪时，我们可以将推特的长度，写推特的时间等作为特征添加。这些特征可能是有用的或没用的，我们有自动的方法来找出哪些是最有用的。直观地说，<strong>特征选择算法</strong>使用技术来评分每个特征，并根据该评分返回最有价值的特征。

另一个重要的事情要记住：避免使用巨大的特征集。有人可能会试图将所有可能的特征添加到模型中，让算法学习。但这不是一个好主意，因为我们添加更多的特征来表示我们的实例，特征空间的维度增加，使其更加稀疏。直观地说，随着我们使用更多的特征，我们必须提供非常多的实例才能体现出特征的组合。这是一个非常普遍的问题，称为维度的诅咒，随着模型复杂度的增长，训练样例的数量需要呈指数级增长，相信我，这是一个问题。

### 训练实例
所以，你必须提供机器学习算法训练实例。根据您想要解决的问题，我们可能会需要数百，数千，数百万或数十亿训练实例。另外，保证训练实例的质量是非常重要的，如果你给算法提供了错误的例子，那么获得好结果的机会就很小。

大量收集质量数据以训练机器学习算法通常是一件昂贵的事情。除非您已经标记了数据，否则您可能必须自己手动标记数据，或者付钱请其他人这样做。一些尝试解决的工具是<strong>众包平台</strong>，您可以在这里找到劳动力来完成这项工作。另外，<strong>自引导(bootstrapping)</strong>是一种通过使用自己的机器学习模式来帮助您使标记更高效的方法。

关于训练实例的一般规则是：您可以收集到更多的优质训练数据，您可能会收到更好的结果。

### 测试示例和性能指标
在我们训练机器学习算法之后，我们必须测试它的执行情况。这是非常重要的，否则你不知道你的模型是否真的学到了什么！

这个概念很简单，我们使用一个<strong>测试集</strong>，一组未包含在训练集中的实例。基本上我们会把每个测试例子都输入到我们的模型中，看看它是否按预期执行。在监督学习分类的情况下，我们只要输入每个测试实例，并检查输出是否是我们所期望的。如果我们的模型在95％的测试例子中返回正确的输出，我们说我们的模型有95％的准确性。

重要的是要记住，训练和测试集的实例必须是不相交的，这是测试模型的概括和预测能力的唯一方法。在训练数据上，您可能会获得非常好的准确性，但是如果在单独的测试集中进行测试，结果会很差。这个问题被称为[过拟合](https://zh.wikipedia.org/wiki/%E9%81%8E%E9%81%A9)，也就是说，该算法过度适应训练样本，具有较差的预测能力。通常，避免这种情况的方法是尝试使用一个特征较少的简单模型，简化模型并使用一个更大，更具代表性的训练集。

精度是最基本的指标，你还应该看看其他指标，如[Precision and recall](https://en.wikipedia.org/wiki/Precision_and_recall)，它会告诉你算法对每个分类（当使用监督学习分类时）执行得有多好。[混淆矩阵](https://zh.wikipedia.org/wiki/%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%98%B5)是一个很棒的工具用来查看我们的分类算法的预测是否“混乱”。

对于回归和聚类问题，您可以使用其他一系列度量标准来查看算法是否运行良好。

### 性能
在现实世界的应用程序中，如果您必须在生产环境中部署解决方案，则必须构建一个强大且高性能的解决方案。在机器学习应用的情况下，这可能是一个复杂的任务。首先，你必须选择机器学习框架，这并不容易，因为并不是所有的编程语言都有强大的工具。Python和[Scikit-learn](http://scikit-learn.org/stable/)就是一个拥有强大的机器学习框架的编程语言的好例子。

选择了您的框架后，可能会出现性能问题。根据所设计的数据量，复杂性和算法的不同，运行训练过程可能需要大量的计算能力和内存。你可能要运行多个训练实例，直到你得到好的结果。此外，通常你可能会重新训练你的模型来覆盖新的实例，并不断提高它的准确性。

为了训练巨大的模型并在使用时获得快速的结果，我们通常会使用大量的内存和cpu来并行处理。

这些主要是实际问题，但是如果您想在生产环境中部署真正的机器学习解决方案，那么这些问题就显得非常重要。

## 最后的话
就是这样，简要概述机器学习的内容。还有很多这里没有涉及到的其他真实世界的应用程序，还有很多其他的机器学习算法和概念可供讨论，但是我们让读者自己做一些研究。

机器学习是强大的，但很难，在这篇文章中描述的困难和方面只是冰山一角。

通常在计算机科学方面有一定的背景，尤其是机器学习，才能取得不错的成绩。在走上正轨之前，人们可能会由于要解决很多困难而感到失望。

这就是为什么我们创建了[MonkeyLearn](https://monkeylearn.com/)，以便将适用于文本分析的机器学习技术的大众化。避免重复创造轮子，让每一位软件开发人员或企业家快速获得实际的结果。这些是我们面临的主要挑战，要将最终用户从所有这些问题中抽象出来，从机器学习的复杂性到实际的可扩展性问题，以便机器学习即插即用。

希望你喜欢这篇文章！只要你有任何问题或意见，请给我一个反馈！

